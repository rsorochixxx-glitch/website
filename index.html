<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1 id="display">0</h1>
    <button id="add">Нажать</button>
    <button id="send">Готово (Отправить)</button>
    <a href="http://127.0.0.1:8000" class="my-button">ПерейтИ</a>

    <script>
        const tg = window.Telegram.WebApp;
        let count = 0;

        document.getElementById('add').onclick = () => {
            count++;
            document.getElementById('display').innerText = count;
        };

        document.getElementById('send').onclick = async () => {
            const queryId = tg.initDataUnsafe.query_id; // Важно для Inline
            
            // ПРАВИЛЬНЫЙ URL твоего сервера на PythonAnywhere
            // Мы отправляем данные на эндпоинт /web-data
            const url = 'http://127.0.0.1:8000/'; 

            await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ 
                    query_id: queryId, 
                    count: count 
                })
            });
            
            tg.close();
        };
    </script>
</body>
</html>
